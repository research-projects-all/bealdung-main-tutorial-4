rules:
- id: SPRING-A01-001
  message: 'Missing Method-Level Security on REST Endpoints (SPRING-A01-001).


    CodeQL: Taint from request to service layer without `@PreAuthorize` check

    SonarCloud: AST pattern - `@RequestMapping` without `@Security` / `@PreAuthorize`
    method-level annotations | Pattern: `@GetMapping("/admin/users") public List<User>
    getAllUsers() { return userService.findAll(); }`


    Notes:

    CodeQL: No Spring Security rule (gap)

    SonarCloud: No method-level rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: GetMapping
  paths:
    include:
    - '*.java'
    - '*.kt'
    - '*.properties'
    - '*.yml'
- id: SPRING-A01-002
  message: '@Controller Without @RequestMapping Method Restrictions (SPRING-A01-002).


    CodeQL: Taint from `@RequestMapping` to all methods when `method` attribute is
    missing or includes multiple HTTP verbs

    SonarCloud: Pattern - `@RequestMapping("/api") public String handle() { ... } //
    Accepts GET, POST, DELETE, etc.`


    Notes:

    SonarCloud: [`java:S3752`](https://rules.sonarsource.com/java/RSPEC-3752/) (covers
    broad mapping but not tutorial-specific context)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: RequestMapping
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A01-003
  message: 'Path Traversal in Resource Resolution (SPRING-A01-003).


    CodeQL: Taint from `@PathVariable` to `ResourceResolver`

    SonarCloud: Pattern - `@GetMapping("/file/{filename}") public Resource
    getFile(@PathVariable String filename) { return new
    ClassPathResource("static/" + filename); }`


    Notes:

    CodeQL: [`java/path-injection`](https://codeql.github.com/codeql-query-help/java/java-path-injection/)
    (covers this)

    SonarCloud: No path traversal rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: ClassPathResource
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A01-004
  message: 'Insecure Direct Object Reference (IDOR) in Repository Access
    (SPRING-A01-004).


    CodeQL: Taint from `@PathVariable` to `repository.findById()` without ownership
    check

    SonarCloud: Pattern - `@GetMapping("/user/{id}") User getUser(@PathVariable Long
    id) { return userRepository.findById(id).get(); } // No check if current user owns
    this ID`


    Notes:

    CodeQL: No IDOR rule (gap)

    SonarCloud: No ownership check rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: repository\.findById
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A01-005
  message: 'WebSocket Without Origin Check (SPRING-A01-005).


    CodeQL: Taint from `WebSocketHandler` to `handleMessage` without origin
    validation

    SonarCloud: Pattern - `registry.addHandler(myHandler(), "/ws").withSockJS(); //
    No setAllowedOrigins("*") or restricted origin`


    Notes:

    CodeQL: No WebSocket rule (gap)

    SonarCloud: No origin check rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: withSockJS
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A01-006
  message: 'CSRF Protection Disabled Globally (SPRING-A01-006).


    CodeQL: Control flow shows `http.csrf().disable()` in SecurityConfig without
    justification

    SonarCloud: Pattern - `http.csrf().disable(); // Applied to web app, not just
    stateless API`


    Notes:

    CodeQL: [`java/spring-disabled-csrf`](https://codeql.github.com/codeql-query-help/java/java-spring-disabled-csrf/)
    (covers this)

    SonarCloud: [`java:S4502`](https://rules.sonarsource.com/java/RSPEC-4502/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: http\.csrf
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A02-001
  message: 'Jasypt Encrypted Password in Properties File (SPRING-A02-001).


    CodeQL: Taint from `application.properties` `jasypt.encryptor.password` to DB
    connection

    SonarCloud: Pattern - `jasypt.encryptor.password=demo-password # In
    application.properties`


    Notes:

    CodeQL: No Jasypt-specific rule (gap)

    SonarCloud: No Jasypt password rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: application\.properties
  paths:
    include:
    - '*.properties'
    - '*.yml'
- id: SPRING-A02-002
  message: 'Weak Password Encoder (NoOp, MD5, SHA-1) (SPRING-A02-002).


    CodeQL: Taint flow to `NoOpPasswordEncoder.getInstance()` or `new
    MessageDigestPasswordEncoder("MD5")`

    SonarCloud: Pattern - `@Bean public PasswordEncoder passwordEncoder() { return
    NoOpPasswordEncoder.getInstance(); }`


    Notes:

    CodeQL: [`java/weak-cryptographic-algorithm`](https://codeql.github.com/codeql-query-help/java/java-weak-cryptographic-algorithm/)
    (covers weak hashes)

    SonarCloud: [`java:S5542`](https://rules.sonarsource.com/java/RSPEC-5542/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: NoOpPasswordEncoder\.getInstance
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A02-003
  message: 'Hard-coded JWT Secret Key (SPRING-A02-003).


    CodeQL: Taint from `application.yml` `jwt.secret: hardcoded` to `Jwts.builder()`

    SonarCloud: Pattern - `String secret = "hardcoded-secret"; Jwts.builder()
    .setClaims(claims).signWith(SignatureAlgorithm.HS256, secret).compact();`


    Notes:

    CodeQL: [`java/hardcoded-credentials`](https://codeql.github.com/codeql-query-help/java/java-hardcoded-credentials/)
    (partially covers)

    SonarCloud: [`java:S2068`](https://rules.sonarsource.com/java/RSPEC-2068/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: Jwts\.builder
  paths:
    include:
    - '*.java'
    - '*.kt'
    - '*.yml'
- id: SPRING-A02-004
  message: 'Insecure Random for Security Context (SPRING-A02-004).


    CodeQL: Taint from `new Random()` to `String token = new Random().nextInt()` for
    security token

    SonarCloud: Pattern - `String token = String.valueOf(new Random().nextInt(10000));
    } // Used for password reset`


    Notes:

    CodeQL: [`java/weak-cryptographic-algorithm`](https://codeql.github.com/codeql-query-help/java/java-weak-cryptographic-algorithm/)
    (covers weak random)

    SonarCloud: No Random security rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: Random
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A02-005
  message: 'TLS Certificate Validation Disabled (SPRING-A02-005).


    CodeQL: Taint from untrusted host to `HttpsURLConnection` / `RestTemplate` with
    custom `X509TrustManager` that trusts all certs

    SonarCloud: Pattern - `sslContext.init(null, new TrustManager[]{new
    X509TrustManager() { public void checkServerTrusted(...) {} }}, new
    SecureRandom()); HttpsURLConnection.setDefaultSSLSocketFactory(sslContext.getSocketFactory());`


    Notes:

    CodeQL: [`java/disabling-hostname-verification`](https://codeql.github.com/codeql-query-help/java/java-disabling-hostname-verification/)
    and related queries

    SonarCloud: [`java:S4830`](https://rules.sonarsource.com/java/RSPEC-4830/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: setSSLContext
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A02-006
  message: 'Hard-coded Secrets in Configuration Files (SPRING-A02-006).


    CodeQL: Taint from config file literal to API client initialization

    SonarCloud: Pattern - `api.key=sk_test_1234567890abcdef # In
    application.properties`


    Notes:

    CodeQL: [`java/hardcoded-credentials`](https://codeql.github.com/codeql-query-help/java/java-hardcoded-credentials/)
    (general)

    SonarCloud: [`java:S2068`](https://rules.sonarsource.com/java/RSPEC-2068/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: api\.key
  paths:
    include:
    - '*.properties'
    - '*.yml'
- id: SPRING-A02-008
  message: 'Insecure HTTP/TLS Configuration (SPRING-A02-008).


    CodeQL: Pattern - `server.ssl.enabled=false` or `@RequestMapping` on HTTP only
    endpoints

    SonarCloud: Pattern: `server.ssl.enabled=false # In production profile`


    Notes:

    CodeQL: No Spring Boot TLS config rule (gap)

    SonarCloud: No direct rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: server\.ssl\.enabled
  paths:
    include:
    - '*.properties'
    - '*.yml'
- id: SPRING-A03-001
  message: 'SQL Injection in JPA @Query (SPRING-A03-001).


    CodeQL: Taint from `@Param` to `@Query` with string concatenation

    SonarCloud: Pattern - `@Query("SELECT u FROM User u WHERE u.name = " + name)`
    List<User> findByName(String name);`


    Notes:

    CodeQL: [`java/sql-injection`](https://codeql.github.com/codeql-query-help/java/java-sql-injection/)
    (covers this)

    SonarCloud: [`java:S3649`](https://rules.sonarsource.com/java/RSPEC-3649/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: Query
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A03-002
  message: 'Command Injection via ProcessBuilder (SPRING-A03-002).


    CodeQL: Taint from user-controlled input to `ProcessBuilder` command

    SonarCloud: Pattern - `new ProcessBuilder("sh", "-c", "rm -rf " + userInput);`


    Notes:

    CodeQL: [`java/command-line-injection`](https://codeql.github.com/codeql-query-help/java/java-command-line-injection/)
    (covers this)

    SonarCloud: [`java:S2076`](https://rules.sonarsource.com/java/RSPEC-2076/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: ProcessBuilder
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A03-003
  message: 'LDAP Injection in Authentication (SPRING-A03-003).


    CodeQL: Taint from `@RequestParam` to LDAP query string for `DirContext.search`

    SonarCloud: Pattern - `String filter = "(uid=" + username + ")"; ctx.search("ou=users,dc=example,dc=com",
    filter, new SearchControls());`


    Notes:

    CodeQL: [`java/ldap-injection`](https://codeql.github.com/codeql-query-help/java/java-ldap-injection/)
    (covers this)

    SonarCloud: No LDAP rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: DirContext\.search
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A03-004
  message: 'SpEL Injection in Expression Parsing (SPRING-A03-004).


    CodeQL: Taint from user input to `SpelExpressionParser` without whitelist

    SonarCloud: Pattern - `SpelExpressionParser parser = new SpelExpressionParser();
    Expression exp = parser.parseRaw(userSuppliedExpression);`


    Notes:

    CodeQL: [`java/spring-expression-language-injection`](https://codeql.github.com/codeql-query-help/java/java-spring-expression-language-injection/)
    (covers this)

    SonarCloud: No SpEL rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: SpelExpressionParser\.parseRaw
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A03-005
  message: 'XSS via Thymeleaf th:utext (SPRING-A03-005).


    CodeQL: Taint from model attribute to `th:utext="${modelAttr}"`

    SonarCloud: Pattern - `<p th:utext="${userComment}"></p> <!-- In Thymeleaf
    template -->`


    Notes:

    CodeQL: [`java/xss`](https://codeql.github.com/codeql-query-help/java/java-xss/)
    (general)

    SonarCloud: [`java:S5131`](https://rules.sonarsource.com/java/RSPEC-5131/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: th:utext
  paths:
    include:
    - '*.html'
    - '*.thymeleaf'
- id: SPRING-A03-006
  message: 'Reflected XSS in Error Pages (SPRING-A03-006).


    CodeQL: Taint from request parameter to `model.addAttribute("error", param)` and
    returned in HTML

    SonarCloud: Pattern - `@GetMapping("/error") public String error(@RequestParam
    String msg, Model model) { model.addAttribute("error", msg); return "error";
    }`


    Notes:

    CodeQL: [`java/xss`](https://codeql.github.com/codeql-query-help/java/java-xss/)
    (covers this)

    SonarCloud: [`java:S5131`](https://rules.sonarsource.com/java/RSPEC-5131/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: ResponseEntity\.ok
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A03-008
  message: 'Untrusted JavaScript Sources (No SRI) (SPRING-A03-008).


    CodeQL: Pattern - `<script src="http://untrusted.com">` without integrity

    SonarCloud: Pattern - `<script src="https://untrusted-cdn.com/jquery.min.js"></script>`


    Notes:

    CodeQL: No SRI rule (gap)

    SonarCloud: No SRI rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: '<script src="http'
  paths:
    include:
    - '*.html'
    - '*.jsp'
- id: SPRING-A04-001
  message: 'CORS Misconfiguration (Allowing All Origins) (SPRING-A04-001).


    CodeQL: Taint from `@CrossOrigin(origins="*")` to controller

    SonarCloud: Pattern - `@CrossOrigin(origins = "*") @RestController public class
    ApiController { ... }`


    Notes:

    CodeQL: [`java/spring-disabled-cors`](https://codeql.github.com/codeql-query-help/java/java-spring-disabled-cors/)
    (covers this)

    SonarCloud: [`java:S5122`](https://rules.sonarsource.com/java/RSPEC-5122/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: CrossOrigin
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A04-002
  message: 'Exposed Actuator Endpoints Without Security (SPRING-A04-002).


    CodeQL: Taint from `/actuator/**` endpoints without security

    SonarCloud: Pattern - `management.endpoints.web.exposure.include=*` in
    application.properties without security config


    Notes:

    CodeQL: No dedicated actuator rule (gap)

    SonarCloud: [`java:S5141`](https://rules.sonarsource.com/java/RSPEC-5141/)
    (partial)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: management\.endpoints
  paths:
    include:
    - '*.properties'
    - '*.yml'
- id: SPRING-A04-003
  message: 'Open Redirect via RedirectView (SPRING-A04-003).


    CodeQL: Taint from `@RequestParam("url")` to `new RedirectView(url)`

    SonarCloud: Pattern - `@GetMapping("/redirect") public RedirectView
    redirect(@RequestParam String url) { return new RedirectView(url); }`


    Notes:

    CodeQL: [`java/open-redirect`](https://codeql.github.com/codeql-query-help/java/java-open-redirect/)
    (covers this)

    SonarCloud: [`java:S5145`](https://rules.sonarsource.com/java/RSPEC-5145/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: RedirectView
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A04-004
  message: 'Missing Security Headers (SPRING Security Filter) (SPRING-A04-004).


    CodeQL: Control flow shows `http.headers().disable()` or missing standard headers

    SonarCloud: Pattern - `http.headers().frameOptions().disable();` without
    compensating headers


    Notes:

    CodeQL: [`java/disabled-web-security`](https://codeql.github.com/codeql-query-help/java/java-spring-disabled-security/)
    (partial)

    SonarCloud: [`java:S5254`](https://rules.sonarsource.com/java/RSPEC-5254/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: http\.headers
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A04-005
  message: 'Missing HTTPS Enforcement (SPRING-A04-005).


    CodeQL: Control flow shows `requiresChannel().anyRequest().requiresInsecure()`
    or no HTTPS redirect

    SonarCloud: Pattern - `http.requiresChannel().anyRequest().requiresInsecure();`


    Notes:

    CodeQL: No direct HTTPS rule (gap)

    SonarCloud: No direct HTTPS rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: requiresChannel
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A04-006
  message: 'Debug/Actuator Mode Enabled in Production (SPRING-A04-006).


    CodeQL: Pattern - `spring-boot-devtools` on classpath or `management.endpoints.web.exposure.include=*`
    in production profile

    SonarCloud: Pattern - `spring-boot-devtools` dependency in `pom.xml`


    Notes:

    CodeQL: No devtools rule (gap)

    SonarCloud: No dedicated devtools rule'
  severity: ERROR
  languages:
  - generic
  pattern-regex: spring-boot-devtools
  paths:
    include:
    - 'pom.xml'
- id: SPRING-A05-001
  message: 'Insecure File Upload Without Validation (SPRING-A05-001).


    CodeQL: Taint from `MultipartFile` to `File` write without validation

    SonarCloud: Pattern - `Files.copy(file.getInputStream(), target.toPath(),
    StandardCopyOption.REPLACE_EXISTING);` without extension or size checks


    Notes:

    CodeQL: [`java/path-injection`](https://codeql.github.com/codeql-query-help/java/java-path-injection/)
    and related queries

    SonarCloud: [`java:S4784`](https://rules.sonarsource.com/java/RSPEC-4784/)
    (partial)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: MultipartFile
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A05-002
  message: 'File Upload Without Size Limits (SPRING-A05-002).


    CodeQL: Pattern - `MultipartFile` upload without `spring.servlet.multipart.max-file-size`
    or size validation

    SonarCloud: Pattern - `MultipartFile file` in controller without size check


    Notes:

    CodeQL: No specific max-size rule (gap)

    SonarCloud: No direct rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: spring\.servlet\.multipart\.max-file-size
  paths:
    include:
    - '*.properties'
    - '*.yml'
- id: SPRING-A05-003
  message: 'Directory Traversal in File Storage (SPRING-A05-003).


    CodeQL: Taint from `MultipartFile.getOriginalFilename()` to `Paths.get(uploadDir,
    filename)`

    SonarCloud: Pattern - `String filename = StringUtils.cleanPath(file.getOriginalFilename());
    Path filePath = this.uploadDir.resolve(filename);`


    Notes:

    CodeQL: [`java/path-injection`](https://codeql.github.com/codeql-query-help/java/java-path-injection/)
    (covers this)

    SonarCloud: [`java:S4784`](https://rules.sonarsource.com/java/RSPEC-4784/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: getOriginalFilename
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A05-004
  message: 'Insecure File Download (Content-Type and Disposition) (SPRING-A05-004).


    CodeQL: Taint from filename to `ResponseEntity.ok().body(resource)` without
    setting `Content-Disposition`

    SonarCloud: Pattern - `return ResponseEntity.ok(resource); // No attachment
    header`


    Notes:

    CodeQL: No specific header rule (gap)

    SonarCloud: [`java:S5693`](https://rules.sonarsource.com/java/RSPEC-5693/)
    (partial)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: ResponseEntity\.ok
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A06-001
  message: 'Maven Dependency Without Version (SPRING-A06-001).


    CodeQL: Pattern - `<dependency><groupId>org.springframework</groupId><artifactId>spring-core</artifactId></dependency>`
    without `<version>` or dependencyManagement

    SonarCloud: Pattern - Dependency without version in `pom.xml`


    Notes:

    CodeQL: No specific rule (gap)

    SonarCloud: No specific rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: '<dependency>'
  paths:
    include:
    - 'pom.xml'
- id: SPRING-A06-002
  message: 'Maven Dependency With Version Range (SPRING-A06-002).


    CodeQL: Pattern - `<version>[1.0,2.0)</version>` in dependency

    SonarCloud: Pattern - Version ranges in `pom.xml`


    Notes:

    CodeQL: No dedicated range rule (gap)

    SonarCloud: No dedicated range rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: '<version>'
  paths:
    include:
    - 'pom.xml'
- id: SPRING-A06-003
  message: 'Logback Vulnerable Version (CVE-2021-44228) (SPRING-A06-003).


    CodeQL: Dependency on `logback-classic:1.2.0` (Log4Shell variant)

    SonarCloud: Pattern - `<artifactId>logback-classic</artifactId><version>1.2.0</version></dependency>`


    Notes:

    CodeQL: No specific CVE rule (gap)

    SonarCloud: No specific CVE rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: logback-classic
  paths:
    include:
    - 'pom.xml'
- id: SPRING-A06-004
  message: 'Vulnerable Spring Boot Starter Version (SPRING-A06-004).


    CodeQL: Dependency on `spring-boot-starter-web:2.3.0.RELEASE` with known CVEs

    SonarCloud: Pattern - `<artifactId>spring-boot-starter-web</artifactId><version>2.3.0.RELEASE</version>`


    Notes:

    CodeQL: No specific starter rule (gap)

    SonarCloud: No specific starter rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: spring-boot-starter-web
  paths:
    include:
    - 'pom.xml'
- id: SPRING-A06-005
  message: 'Vulnerable Jackson Databind Version (SPRING-A06-005).


    CodeQL: Dependency on `com.fasterxml.jackson.core:jackson-databind:2.9.x` with
    known CVEs

    SonarCloud: Pattern - `<artifactId>jackson-databind</artifactId><version>2.9.10.3</version>`


    Notes:

    CodeQL: No specific Jackson CVE rule (gap)

    SonarCloud: No specific Jackson CVE rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: jackson-databind
  paths:
    include:
    - 'pom.xml'
- id: SPRING-A06-006
  message: 'Unpinned Dependencies (No Dependency Management) (SPRING-A06-006).


    CodeQL: Pattern - Direct dependency version literals not managed under
    `<dependencyManagement>`

    SonarCloud: Pattern - `<artifactId>guava</artifactId><version>28.0</version></dependency>`


    Notes:

    CodeQL: No specific management rule (gap)

    SonarCloud: No specific management rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: dependencyManagement
  paths:
    include:
    - 'pom.xml'
- id: SPRING-A06-007
  message: 'Remote JavaScript Without Integrity (SRI) (SPRING-A06-007).


    CodeQL: Pattern - `<script src="https://cdn.example.com/lib.js"></script>` without
    `integrity` attribute

    SonarCloud: Pattern - `<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>`


    Notes:

    CodeQL: No SRI rule (gap)

    SonarCloud: No SRI rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: integrity
  paths:
    include:
    - '*.html'
    - '*.jsp'
- id: SPRING-A07-001
  message: 'Plaintext Password Storage in Database (SPRING-A07-001).


    CodeQL: Taint from password field to `user.setPassword(rawPassword)` without
    encoder

    SonarCloud: Pattern - `user.setPassword(password); // No passwordEncoder`


    Notes:

    CodeQL: [`java/plaintext-storage`](https://codeql.github.com/codeql-query-help/java/java-plaintext-storage/)
    (covers this)

    SonarCloud: [`java:S2053`](https://rules.sonarsource.com/java/RSPEC-2053/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: user\.getPassword
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A07-002
  message: 'Password Reset Token Predictable or Reused (SPRING-A07-002).


    CodeQL: Taint from `Random` / timestamp to password reset token

    SonarCloud: Pattern - `String token = String.valueOf(System.currentTimeMillis());`


    Notes:

    CodeQL: [`java/weak-cryptographic-algorithm`](https://codeql.github.com/codeql-query-help/java/java-weak-cryptographic-algorithm/)
    (partial)

    SonarCloud: No token rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: System\.currentTimeMillis
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A07-003
  message: 'Username Enumeration via Error Messages (SPRING-A07-003).


    CodeQL: Taint from `authException.getMessage()` to response showing different
    messages for user-not-found vs wrong-password

    SonarCloud: Pattern - `if (!userExists) { throw new UsernameNotFoundException("User
    not found"); } else { throw new BadCredentialsException("Invalid password");
    }`


    Notes:

    CodeQL: No specific username enumeration rule (gap)

    SonarCloud: No specific enumeration rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: authException\.getMessage
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A07-004
  message: 'Password Reset Token Not Invalidated After Use (SPRING-A07-004).


    CodeQL: Dataflow shows token deleted from DB but not checked if used

    SonarCloud: Pattern - `if (token.isValid()) { // No mark as used`<br>`user.setPassword(newPassword);
    }`


    Notes:

    CodeQL: No explicit token invalidation rule (gap)

    SonarCloud: No explicit token invalidation rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: setPassword
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A07-005
  message: 'Missing Password Strength Validation (SPRING-A07-005).


    CodeQL: Taint from password field to `user.setPassword(password)` without
    strength check

    SonarCloud: Pattern - `user.setPassword(password); // No validation of password
    strength`


    Notes:

    CodeQL: No strength rule (gap)

    SonarCloud: No strength rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: setPassword
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A07-006
  message: 'Missing Account Lockout Mechanism (Brute-Force Protection)
    (SPRING-A07-006).


    CodeQL: Control flow shows authentication logic without failed attempts counter

    SonarCloud: Pattern - `public void login(String u, String p) { // No lockout logic
    } }`


    Notes:

    CodeQL: No lockout rule (gap)

    SonarCloud: No lockout rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: login
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A08-001
  message: 'Insecure Deserialization with Default Jackson (SPRING-A08-001).


    CodeQL: Taint from `request.getInputStream()` to `objectMapper.readValue(,
    Object.class)` with default typing

    SonarCloud: Pattern - `Object data =
    objectMapper.readValue(request.getInputStream(), Object.class); //
    Deserializes any class`


    Notes:

    CodeQL: [`java/unsafe-deserialization`](https://codeql.github.com/codeql-query-help/java/java-unsafe-deserialization/)
    (partial)

    SonarCloud: [`java:S2092`](https://rules.sonarsource.com/java/RSPEC-2092/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: readValue
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A08-002
  message: 'Missing Signature Verification for Webhook Payloads (SPRING-A08-002).


    CodeQL: Taint from `request.getInputStream()` to business logic without HMAC
    verification

    SonarCloud: Pattern - `@PostMapping("/webhook") public ResponseEntity<String>
    webhook(HttpServletRequest request) { // No signature check }`


    Notes:

    CodeQL: No webhook rule (gap)

    SonarCloud: No webhook rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: PostMapping
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A08-003
  message: 'Template Injection via FreeMarker (SPRING-A08-003).


    CodeQL: Taint from model map to `Configuration.getTemplate()` with untrusted
    template name

    SonarCloud: Pattern - `Template t = configuration.getTemplate(templateName);`
    with user-controlled `templateName`


    Notes:

    CodeQL: [`java/template-injection`](https://codeql.github.com/codeql-query-help/java/java-template-injection/)
    (general)

    SonarCloud: No FreeMarker-specific rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: Configuration\.getTemplate
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A08-004
  message: 'Maven Dependency with Known CVE (No Version Management) (SPRING-A08-004).


    CodeQL: Dependency graph shows library version with CVE and no
    `<dependencyManagement>`

    SonarCloud: Pattern - `<artifactId>jackson-databind</artifactId><version>2.9.10.3</version></dependency>`


    Notes:

    CodeQL: No automatic CVE mapping for tutorials

    SonarCloud: No automatic CVE mapping for tutorials'
  severity: ERROR
  languages:
  - generic
  pattern-regex: dependencyManagement
  paths:
    include:
    - 'pom.xml'
- id: SPRING-A08-005
  message: 'Missing Checksum Verification for Downloaded Dependencies
    (SPRING-A08-005).


    CodeQL: Control flow shows `maven-dependency-plugin:copy` without checksum
    verification

    SonarCloud: Pattern - `curl https://repo.maven.apache.org/maven2/.../app.jar  #
    No checksum`


    Notes:

    CodeQL: No checksum rule (gap)

    SonarCloud: No checksum rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: "maven-dependency-plugin:copy"

  paths:
    include:
    - 'pom.xml'
- id: SPRING-A09-001
  message: 'Clear-text Logging of Sensitive Data (SPRING-A09-001).


    CodeQL: Taint from password or token to logger

    SonarCloud: Pattern - `log.info("User password: {}", user.getPassword());`


    Notes:

    CodeQL: [`java/log-injection`](https://codeql.github.com/codeql-query-help/java/java-log-injection/)
    (partial)

    SonarCloud: [`java:S2068`](https://rules.sonarsource.com/java/RSPEC-2068/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: user\.getPassword
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A09-002
  message: 'Insufficient Exception Logging (Swallowing Security Exceptions)
    (SPRING-A09-002).


    CodeQL: Control flow shows catch block that ignores security exceptions

    SonarCloud: Pattern - `catch (AuthenticationException e) { // empty }`


    Notes:

    CodeQL: [`java/ignored-exceptions`](https://codeql.github.com/codeql-query-help/java/java-ignored-exceptions/)
    (general)

    SonarCloud: [`java:S108`](https://rules.sonarsource.com/java/RSPEC-108/)
    (partial)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: catch
  paths:
    include:
    - '*.java'
    - '*.kt'

- id: SPRING-A09-004
  message: 'Stack Trace Exposed to Client (SPRING-A09-004).


    CodeQL: Taint from exception to response body

    SonarCloud: Pattern - `catch (Exception e) { return
    ResponseEntity.status(500).body(e.getMessage()); }` or `e.printStackTrace();`
    in controller


    Notes:

    CodeQL: [`java/stack-trace-exposure`](https://codeql.github.com/codeql-query-help/java/java-stack-trace-exposure/)
    (covers this)

    SonarCloud: [`java:S2228`](https://rules.sonarsource.com/java/RSPEC-2228/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: Exception\.printStackTrace
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A09-005
  message: 'No Security Event Logging for Failed Logins (SPRING-A09-005).


    CodeQL: Authentication failure path without log call

    SonarCloud: Pattern - `catch (BadCredentialsException e) { // no log.warn }`


    Notes:

    CodeQL: No failed-login logging rule (gap)

    SonarCloud: No failed-login logging rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: log\.warn
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A10-001
  message: 'SSRF via RestTemplate with User-Controlled URL (SPRING-A10-001).


    CodeQL: Taint from request parameter to `RestTemplate.getForObject()` URL

    SonarCloud: Pattern - `restTemplate.getForObject(url, String.class);` with
    unvalidated `url`


    Notes:

    CodeQL: [`java/ssrf`](https://codeql.github.com/codeql-query-help/java/java-ssrf/)
    (covers this)

    SonarCloud: [`java:S5443`](https://rules.sonarsource.com/java/RSPEC-5443/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: restTemplate\.getForObject
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A10-002
  message: 'File Disclosure via file: Protocol in ResourceLoader (SPRING-A10-002).


    CodeQL: Taint from `@PathVariable` to `resourceLoader.getResource("file:" +
    path)`

    SonarCloud: Pattern - `return resourceLoader.getResource("file:" + path); //
    /etc/passwd`


    Notes:

    CodeQL: [`java/path-injection`](https://codeql.github.com/codeql-query-help/java/java-path-injection/)
    (covers this)

    SonarCloud: No specific file protocol rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: resourceLoader\.getResource
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A10-003
  message: 'JNDI Injection via User-Controlled Name (SPRING-A10-003).


    CodeQL: Taint from request parameter to `new InitialContext().lookup(name)`

    SonarCloud: Pattern - `public Object jndi(String name) { return new
    InitialContext().lookup(name); } // JNDI injection`


    Notes:

    CodeQL: [`java/jndi-injection`](https://codeql.github.com/codeql-query-help/java/java-jndi-injection/)
    (covers this)

    SonarCloud: [`java:S6437`](https://rules.sonarsource.com/java/RSPEC-6437/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: InitialContext
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A10-004
  message: 'XXE in XML Parsing with DocumentBuilder (SPRING-A10-004).


    CodeQL: Taint from `request.getInputStream()` to `DocumentBuilder.parse()` without
    secure factory settings

    SonarCloud: Pattern - `DocumentBuilderFactory dbf =
    DocumentBuilderFactory.newInstance(); DocumentBuilder db =
    dbf.newDocumentBuilder(); db.parse(request.getInputStream()); // XXE`


    Notes:

    CodeQL: [`java/xxe`](https://codeql.github.com/codeql-query-help/java/java-xxe/)
    (covers this)

    SonarCloud: [`java:S2755`](https://rules.sonarsource.com/java/RSPEC-2755/)
    (overlaps)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: request\.getInputStream
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A10-005
  message: 'DNS Rebinding via SSRF Filter Bypass (SPRING-A10-005).


    CodeQL: Taint from URL to `RestTemplate` with DNS rebinding checks missing or
    bypassed

    SonarCloud: Pattern - `restTemplate.getForObject(url, String.class); // Resolves
    DNS on each request`


    Notes:

    CodeQL: [`java/ssrf`](https://codeql.github.com/codeql-query-help/java/java-ssrf/)
    (covers this)

    SonarCloud: No DNS rebinding-specific rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: restTemplate\.getForObject
  paths:
    include:
    - '*.java'
    - '*.kt'
- id: SPRING-A10-006
  message: 'Blind Trust of Proxy Headers (IP Spoofing) (SPRING-A10-006).


    CodeQL: Taint from `X-Forwarded-For` header used directly without validation

    SonarCloud: Pattern - `String ip = request.getHeader("X-Forwarded-For"); // Trust
    user-provided IP`


    Notes:

    CodeQL: No proxy header rule (gap)

    SonarCloud: No proxy header rule (gap)'
  severity: ERROR
  languages:
  - generic
  pattern-regex: request\.getHeader
  paths:
    include:
    - '*.java'
    - '*.kt'
